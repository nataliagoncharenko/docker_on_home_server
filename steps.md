# Установка Docker на Ubuntu Server на DEXT Compact M008

Обновление списка пакетов и пакетов:

sudo apt update && sudo apt upgrade -y

apt (Advanced Package Tool) - менеджер пакетов в Ubuntu (без него ни один пакет не поставить, не обновить, не удалить). Отвечает за: установку, удаление, обновление, поиск, проверку зависимостей.
Как работает:
В случае с Docker apt идет в репозиторий, находит пакет, проверяет, что еще нужно для работы программы (зависимости) и ставит все автоматически
Зависимости - программы, без которых не может работать Docker. Apt сам находит такие программы, проверяет,установлены ли они и если нет, то ставит автоматически. 

## Установка Docker 

* Установить зависимости: 
sudo apt install -y ca-certificates curl gnupg

Здесь установка трех пакетов: 
1) ca-certificates - набор доверенных сертификатов, которые используются для проверки подлинности HTTPS-сайтов. Сертификаты помогают установить безопасное соединение и защитить от подмены данных
2) curl - утилита командной строки для передачи данных по разным протоколам, нужна чтобы скачать GPG-ключ Docker
3) gnupg (GPG-ключ Docker) - инструмент для шифрования и проверки цифровых подписей. Здесь он нужен,ч тобы проверить GPG-ключ Docker репозитория. Проверяет не поддельные ли ключи, без этого бы система не доверяла репозиторию. 

* Добавить официальный GPG-ключ Docker:

sudo install -m 0755 -d /etc/apt/keyrings

Разбор команды:
sudo - стандартно права администратора
install - команла, которая умеет копировать файлы и создавать директории с нужными правами 
-m 0755 - задает права доступа к папке: владелец может читать, писать и входить, все остальные только входить и читать
-d - создание директории
/etc/apt/keyrings - место у Ubuntu, куда складывают GPG-ключи для доверенных репозиториев

* Скачивание и преобразование GPG-ключа:
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

Разбор команды: 
curl -fsSL https://download.docker.com/linux/ubuntu/gpg - скачивание GPG-ключ с официального сервера
флаги -fsSL 
| - передает результат первой команды (ключ) сразу второй на вход

sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg - преобразование сырого ключа в ASCII в бинарный формат .gpg :
--dearmor - преобразование 
-o - указание, куда сохранить

* Разрешение на чтение ключа для всех 

sudo chmod a+r /etc/apt/keyrings/docker.gpg

Разбор команды:
chmod - смена прав доступа
a+r - всем добавить право на чтение (all+read)

* Добавление репозитория Docker

echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
 Разбор команды:
 - добавляет официальный репозиторий Docker в систему, чтобы apt знал, что ему можно доверять и ставить Docker

 - echo "..." - печатает строку, которая описывает откуда брать пакеты
 - deb - тип репозитория, репозиторй я бинарными пакетами, которые умеет читать apt
 - [arch=$(dpkg --print-architecture)] - указывает архитектуру процессора, команда подстановка (запускается и возвращает архитектуру процессора). Нужно, чтобы apt скачал только те пакеты, которые подходят для конкретного компьютера.
 - signed-by=/etc/apt/keyrings/docker.gpg - указывает, кто подписан, apt будет доверять только тем пакетам, которые подписаны этим ключом.
 - https://download.docker.com/linux/ubuntu - ссылка на официальный сервер Docker, где лежат пакеты для Ubuntu
 - $(. /etc/os-release && echo "$VERSION_CODENAME") - подставляет кодовое слово для Ubuntu

